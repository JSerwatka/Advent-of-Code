from functools import reduce

trees = ["..#.......#..##...#...#..#.#...",
        "..##..#..#.....#.........#....#",
        "...#.##..#.#......#.#....#.....",
        "...#.....#......#...#..........",
        ".......#.#..#..#....##....##...",
        ".#......#......#.#..#....#.#...",
        ".#..........#.....###.##..#.#..",
        "....#...##...........#.........",
        "##......#.#...#...#....##.#...#",
        ".....#.....#.#..#....###...#..#",
        ".#....#.........#...#.......#.#",
        ".##......#.#.........#....#.#..",
        "...#........###..#......##....#",
        ".#.....###..........#...#....##",
        "............#......#...#...#..#",
        ".....#.#....#.#.#...........#.#",
        "....#.....#...##.##.....###..#.",
        ".....#.##......#.##.#...#.#.#..",
        "##.....#.##.##....#..##......#.",
        ".....#.....#........#........##",
        "#..#...#.#.#..##....#....##..#.",
        ".#......................##..#..",
        "#.#.#................#.....#...",
        "..#....#.#.#..##..#..#.....##..",
        ".....###..#.............#....##",
        "..#....#.#...#......###..#.....",
        ".......####.....##......#......",
        "..##...#..#...#.#..#......#....",
        "..##..#..#.....#......##.##....",
        ".#......#................#..#.#",
        "...............#....#.......#..",
        "#...........#.#.#........#.#...",
        "...#...#..#.....##..#.##...#.#.",
        ".#.#..#.#.....#...#..##....#.##",
        ".........#...#.#.#....#.......#",
        "............##.#..#.#........#.",
        "#..#..#........#......####.....",
        "..#.#...#...#...#.#...#..#..#..",
        "#....................#.#.#....#",
        ".......#.....#....#....##..#...",
        ".......#.............##.....#..",
        "..##..#.......#..#.........#..#",
        "..##.#........#...#...#..#..#..",
        "..##.#...#................#..#.",
        "..#.....##...##......###.....#.",
        ".....#.....#......#......#.....",
        "....##.#.#....#.....#..........",
        "...#...#.#.....#.###.....#....#",
        "......##....#..##...##.#.......",
        "......................##......#",
        ".##......#...#...#...##.#.##.#.",
        "#.......#...#.....#........#.#.",
        "...............#......#.......#",
        ".#..##...#....#.....###....##..",
        "...#..###...#..#....#.#..#.....",
        ".#...#....#.................#..",
        ".......##....#..##......#.#....",
        "....#.....#.....###...#....#...",
        "..##..#..##........#...........",
        "....#..#.#............#........",
        "####.....##.........#....#.....",
        "........#.....#......#......##.",
        "#..........#........#....#...##",
        "#..#...###.....##.....#.##...#.",
        "......#....##.............#..#.",
        "..#......###...#...#..##.....#.",
        "#.##...#......##.###....#....#.",
        "...............#....#.....###.#",
        "#......#........#.#..##.#.....#",
        "#..............#..##.#....#....",
        ".##....###...#...#.#....#....#.",
        ".......#...#.......#....#..##..",
        "..##.#.....#..#...............#",
        ".##..............#.......#...#.",
        ".....#...#.#..#.........#..#...",
        "........#.#.###......#..#......",
        "..#.......###..#...#...........",
        "............#.#.....#....#...#.",
        "#...#..#......#..#......#......",
        "..##..#......#..#.......#.....#",
        "............#.##.....#.#...#...",
        "....#.#...#.#...#........##....",
        "........##...#...##.....#.#..#.",
        ".#..........#.##...............",
        "###.#..#...###..###..#........#",
        "....#..#............#...#.#.#..",
        ".#....###........#.......#...#.",
        "..........#..#.....#......#....",
        "..##..#.#....#..#.....##....#..",
        "...#...............#......#....",
        "......#.#.#...###.....##.#.....",
        ".#...#.#.#.#....#.....#..#..#.#",
        "..#.....#..##....#......#.#.#..",
        "##.#....#.......#.#.#.......#..",
        ".#.#.#........##.#....#........",
        "...#..#...#.#.........#..#....#",
        "#.#......#.#.#..#.#............",
        "......#.....#.....#.......#..#.",
        ".........#..#.##..#..###....#.#",
        ".......#..........#..#.........",
        "......#.#.##...#.#...##........",
        "...........##..##.##....#......",
        "..#..#...#.###...##.....#..#..#",
        ".#...##.......#.#..........#..#",
        "##......#...........#.#........",
        "..#..#.....##..#.#.......#...#.",
        ".#....#..#.....###.......#...#.",
        "...#..#...#...###.#.###..#.....",
        ".......#...#.##......#.#.#.#...",
        ".#.......#...#...#...##........",
        "...#........#....#..#.#...#.#..",
        "..#............#.....#.#....#..",
        "#.....#.#..#.#....#...#.#.#....",
        "#......#......##.#...........#.",
        ".#..#.........##.#........#....",
        ".#....#.#...#........#......#..",
        "....#..#..#....#..#.#.....#..#.",
        ".##.#.....#..#.#...#.....#..###",
        "#..#......#..##....##..#.......",
        ".......#..##....#.###..........",
        ".#......#..........#........#..",
        ".........#.....#......#.#......",
        ".....#..#.......#...#.#....#...",
        ".#......#...#..#......#.....#.#",
        "#.#.#..#.........#.......##....",
        "...#..#.....#.#..#......#...#..",
        ".##...#...#.#....#.....#.#...#.",
        "..#......##......#....#.#..#...",
        "....#.#.....#..#...........#...",
        ".#........#....#....#...#......",
        "..#.#.....#.......#.#.#.##..##.",
        "...#..#.##.......#...#.........",
        "....##.#.#..#.#..#.#.#..#.#.#.#",
        "......#.......#.....#...##.#...",
        "..#.##.....#....#...#...##.##.#",
        "..##.........##.........#..#...",
        ".....###......####..#.#...#....",
        "...#....#....##.............#.#",
        ".#.........#.......##..#.#.....",
        "...#..#........#...............",
        "........#........##......#.#...",
        "##...#......#.....#.##........#",
        ".............#.#........#......",
        ".......##.........#.......#....",
        "....#.......#......#..###....#.",
        ".#.##........#.....#......#....",
        "#...........##...#..##.........",
        ".....#.#........#........##...#",
        "#.........#..##.....#...#....#.",
        ".........#...####..#....###....",
        "###.#..##.......#....#....#.##.",
        "...........#.....#.#...#..#....",
        ".##......###.#.#.#....#........",
        "....#..................#.###.#.",
        "#..##...#......#...#......###..",
        ".#.....#..##......#.#.#.#......",
        "..##...#..#.......##.#.......#.",
        "...#..#..##..##..##.#..####....",
        "......#..#..............#.#####",
        "....#....#..#...#...#.#........",
        ".###...#.......#..#........#...",
        "........#.#......##...#........",
        ".#..#.......##.......#.....##..",
        "...##..........##...........#..",
        "......................#..#.#.#.",
        "#..#.....#......#.....#....#.##",
        "..#......#.....#....#...#.##.#.",
        "............#...#...#......#.##",
        "........##.......#......##.....",
        "..#.##.....#....#..##...#......",
        "........#.#...##.#..#...#....#.",
        "...##............##.....#..#...",
        "...###.##....#....#.#.#.#..#...",
        "............#..#....#..#.....##",
        "...#......##.......#......##..#",
        ".......#......#........#.....#.",
        ".#....#.##..........#..........",
        "..###.........#..#...##.....#..",
        "##....##..#.......###....#.#.#.",
        "#.......#.#.##.................",
        "..#..........#................#",
        "....#.#....#...###...#......#..",
        ".#..........#..#..##.....#...##",
        ".#.....###....#.#...#.#........",
        ".........##.........#..#.#.....",
        ".#.....##....#......##.#....#..",
        "###..#...#..#.........#......#.",
        "..##.....#....#............#...",
        ".....##.##....#.....#..#..#....",
        ".......###...#..........#......",
        "...#........#....#.##.#........",
        "........###....##........##.#..",
        "....#....#........#.....##.....",
        ".#........#.#........#...#..#..",
        "#..#..#......#....##.#..###....",
        "...........#...#...#....#.#...#",
        ".#..#.....#.##..#......##......",
        "..#.#...............##..##.###.",
        "...#.#...#............##.#..#..",
        ".#.#....#....#................#",
        "...#..#.#.##.#.#....#......#...",
        ".........#..#.......##.##.#....",
        "..............#..##.#.....#....",
        "......#.........#...#...##.#..#",
        "....##.....#.#...#.#.####.#....",
        "#..#.#....#.##.......#....#....",
        "...##....#...................##",
        "##.#.......#....#.#.........#.#",
        ".##.#..###...#.#.........#.....",
        "...#.#.#..#...#...#.##....#..#.",
        "....#.....###...#....##........",
        ".............#....#....#....#..",
        "#...#.....#.#...#.#............",
        "#.#....#...........##.......#..",
        "..#..#.........#....###.......#",
        "....###..................##...#",
        ".#........#.....##...#......#..",
        "#..#......#..#.....#.##..#...#.",
        "....#........#.##.#......#.....",
        "#.#...#...............####...##",
        "#.#.....##..#.####.............",
        "##...##..#.##........#.#...#...",
        "...#...........#............#..",
        "...#..#..#........##...........",
        "..#.##..#.#...#...#..#......#..",
        ".....##......#...##.....##.....",
        ".......##.....##....#..........",
        "..........#.#...............#.#",
        "#.#..........#..#..##..#...#..#",
        ".#.#..#.###................#...",
        "#...#...#....#...#....#.##.##..",
        ".#................###.....##...",
        ".....##.#.....##.#.....#.....##",
        ".......#.......#......#.#......",
        "..#....#......#.....#.....#..#.",
        "#......#..##..####.....#.#..#..",
        ".......#...###..#...#.....#....",
        "#.#.#......#.............#..###",
        ".#.#.......#..#.#..#..#...#.#..",
        "..#.#......#......#.#....#.....",
        "..#..###..#.#.....#....#.......",
        "..........#........#......#..#.",
        "##..........##....##..###.##...",
        "...#....#.......#..##.......#..",
        "##...#............##...#.#.#.#.",
        "...........#...#.#....#.....##.",
        ".#................#.......#...#",
        "....##.#..#.#.........###.###.#",
        "#..#...###..#...#......#..##...",
        "..##........#.#..##.#..........",
        "...#..#...#...............#.#..",
        "##.##....#...#........#...#....",
        "#..#......#.##.................",
        ".....#..##.##.......#..........",
        "...#.....#........#......#.....",
        ".....#..#......#.....##...#....",
        "#......#...###....#....###.....",
        "................###..#..#..#.##",
        "......#.......#..........#.#..#",
        "###..#..#.##.............#.#...",
        "....##.#.......#...#..##.......",
        "..#.....##..#..#..#.#..........",
        ".#.......#.#..#........##......",
        "..............#.........#......",
        "..#........##....#.#.#......##.",
        ".#.#.........#.#...#.#.........",
        "..........#..#.##.#....#...#.#.",
        "............##....#.....###...#",
        "#....#..#...#.#...#.....#....#.",
        ".#...##.....#......#..#........",
        ".#..#...###.#..##........#...#.",
        "#..#...##.####.......#.....#...",
        "#.##..#...#......#.#.......#.#.",
        "#.#.....##...#.#...............",
        "#...........##.##.#.........#..",
        "...#...........#.#.#.#....#..#.",
        "..#......#.#.#....##..#.#.....#",
        ".........#.#.##...##...#.#.#...",
        "...........#..#.####.#..#.#.###",
        "#........#.#......#..#...#.....",
        "...#....#......##...#.#........",
        "......#.#....#.##....#....#..##",
        ".......###......#.#.....#......",
        "#..........##..................",
        ".###.......##..#..##...##......",
        "##.#..............#....#....##.",
        "#....#.....#.##.....#..#....#.#",
        ".......#.......#..#..#..##..#..",
        "......#...........#..##....#...",
        ".....#.......#..#......#..#..##",
        ".##...#......#........#....#...",
        ".....#..#....#...............##",
        "..#.....#....#..#.##....#.#....",
        "#.#......####...#..#.........#.",
        "#.#........#..#........#...#...",
        "..#..............#.......###.#.",
        "...#.#....##.#......#........#.",
        "....###.......##.#.....##.....#",
        ".........#......#.#.......##.##",
        ".......#.#....#.#...#...#....#.",
        "....#....#....#.#.......##.....",
        "#...#.....#..#.....#...........",
        "#...#..#...#.#..#.............#",
        "........###..#........#........",
        ".............#....#..###..#.#.#",
        "#...............#..#.#.........",
        "##.....###..#......#...#....#..",
        ".#...................##.#.##...",
        "#..#........#.#...#..#...#.....",
        "................#.#.........#..",
        "#.....##.#.#...#..#.........##.",
        "...#.....#....#..####.#........",
        "....#.#...........#............",
        ".....#........##..........#....",
        "..#.......#.#.#.####..#......#.",
        "#.......#...##.#.#..#.#.#......",
        "##........#.#...###............",
        "..##........#........#...#.#.#.",
        "#.#..#.#.......#....#........#.",
        "..............#....#.........#.",
        "#....#.#........#.............#",
        "..##...#..........#........#...",
        "..#..#..#....#....#............"]

trees_test = ["..##.......",
              "#...#...#..",
              ".#....#..#.",
              "..#.#...#.#",
              ".#...##..#.",
              "..#.##.....",
              ".#.#.#....#",
              ".#........#",
              "#.##...#...",
              "#...##....#",
              ".#..#...#.#"]


def find_trees(tree_pattern, right, down):
    # i_idx = row
    # j_idx = element of a row
    counter = 0
    j_idx = 0
    row_len = len(tree_pattern[0])

    for i_idx in range(0, len(tree_pattern), down): 
        if tree_pattern[i_idx][j_idx % row_len] == "#":
            counter += 1
        j_idx += right
    
    return counter

def trees_multiply(tree_pattern, step_patterns):
    counts = []

    for step_pattern in step_patterns:
        counts.append(find_trees(tree_pattern, step_pattern[0], step_pattern[1]))

    return reduce((lambda x, y: x * y), counts)


step_patterns = [(1, 1), (3, 1), (5, 1), (7, 1), (1, 2)]

print(trees_multiply(trees, step_patterns))