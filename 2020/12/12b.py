import numpy as np

''' 
matrix x vector
    |a b|   | x |   | ax + by |
    |   | x |   | = |         |
    |c d|   | y |   | cx + by |

numpy matrix x vector
    matrix = np.array([a, b],
                    [c, d])
    vector = np.array([x, y])

    result = matrix.dot(vector)
'''

''' 
vector by angle 
    |cos0 -sin0|   | x |
    |          | x |   |
    |sin0  cos0|   | y |
'''

# coord_list_test = [["F", 10],
#                    ["N", 3],
#                    ["F", 7],
#                    ["R", 90],
#                    ["F", 11]]

coord_list = [["F", 93],
              ["R", 90],
              ["F", 81],
              ["E", 3],
              ["F", 80],
              ["R", 90],
              ["W", 4],
              ["R", 90],
              ["F", 64],
              ["N", 1],
              ["R", 90],
              ["W", 4],
              ["F", 11],
              ["W", 1],
              ["L", 180],
              ["F", 28],
              ["R", 90],
              ["W", 4],
              ["L", 180],
              ["F", 95],
              ["N", 3],
              ["F", 71],
              ["L", 90],
              ["W", 1],
              ["F", 1],
              ["E", 2],
              ["L", 90],
              ["F", 85],
              ["W", 3],
              ["L", 90],
              ["F", 28],
              ["E", 3],
              ["N", 5],
              ["F", 47],
              ["S", 2],
              ["R", 90],
              ["N", 2],
              ["L", 90],
              ["W", 4],
              ["L", 180],
              ["W", 3],
              ["F", 51],
              ["F", 77],
              ["L", 90],
              ["W", 5],
              ["N", 5],
              ["W", 3],
              ["S", 5],
              ["W", 5],
              ["R", 180],
              ["N", 1],
              ["W", 3],
              ["S", 5],
              ["F", 36],
              ["W", 1],
              ["F", 34],
              ["N", 4],
              ["F", 40],
              ["E", 2],
              ["S", 3],
              ["R", 90],
              ["W", 5],
              ["S", 2],
              ["N", 4],
              ["R", 90],
              ["S", 2],
              ["L", 90],
              ["N", 4],
              ["L", 90],
              ["S", 2],
              ["E", 1],
              ["F", 2],
              ["N", 4],
              ["F", 65],
              ["N", 1],
              ["F", 46],
              ["R", 180],
              ["F", 60],
              ["N", 4],
              ["F", 45],
              ["R", 90],
              ["S", 3],
              ["L", 90],
              ["F", 70],
              ["W", 4],
              ["L", 270],
              ["N", 4],
              ["F", 49],
              ["E", 3],
              ["F", 52],
              ["R", 180],
              ["F", 5],
              ["E", 5],
              ["R", 90],
              ["F", 43],
              ["L", 90],
              ["S", 4],
              ["F", 54],
              ["N", 1],
              ["F", 7],
              ["S", 2],
              ["F", 91],
              ["S", 4],
              ["N", 3],
              ["E", 3],
              ["S", 4],
              ["L", 180],
              ["F", 15],
              ["S", 2],
              ["F", 90],
              ["W", 5],
              ["S", 2],
              ["F", 80],
              ["N", 4],
              ["L", 90],
              ["R", 90],
              ["N", 4],
              ["E", 2],
              ["R", 180],
              ["E", 5],
              ["F", 62],
              ["L", 90],
              ["N", 5],
              ["F", 77],
              ["N", 5],
              ["F", 75],
              ["E", 2],
              ["L", 90],
              ["S", 4],
              ["F", 55],
              ["E", 1],
              ["N", 5],
              ["F", 57],
              ["R", 90],
              ["F", 6],
              ["L", 90],
              ["N", 3],
              ["E", 5],
              ["L", 180],
              ["N", 2],
              ["L", 270],
              ["N", 5],
              ["F", 8],
              ["E", 2],
              ["F", 88],
              ["E", 3],
              ["N", 3],
              ["E", 4],
              ["R", 90],
              ["N", 1],
              ["W", 5],
              ["R", 90],
              ["N", 4],
              ["E", 3],
              ["S", 3],
              ["R", 90],
              ["N", 1],
              ["E", 2],
              ["F", 4],
              ["N", 4],
              ["R", 90],
              ["N", 3],
              ["W", 5],
              ["L", 180],
              ["E", 1],
              ["F", 2],
              ["N", 4],
              ["W", 5],
              ["F", 80],
              ["S", 4],
              ["F", 7],
              ["L", 180],
              ["F", 96],
              ["L", 90],
              ["F", 16],
              ["L", 90],
              ["E", 4],
              ["F", 78],
              ["W", 2],
              ["R", 90],
              ["S", 3],
              ["F", 29],
              ["W", 4],
              ["R", 90],
              ["E", 4],
              ["F", 39],
              ["N", 1],
              ["F", 48],
              ["E", 4],
              ["L", 180],
              ["E", 1],
              ["R", 180],
              ["E", 2],
              ["R", 90],
              ["N", 3],
              ["R", 180],
              ["W", 2],
              ["N", 5],
              ["W", 5],
              ["E", 3],
              ["F", 25],
              ["E", 1],
              ["L", 180],
              ["N", 5],
              ["F", 44],
              ["L", 90],
              ["N", 4],
              ["W", 4],
              ["L", 90],
              ["F", 72],
              ["L", 90],
              ["S", 1],
              ["E", 5],
              ["N", 5],
              ["R", 90],
              ["N", 1],
              ["W", 3],
              ["S", 5],
              ["R", 90],
              ["W", 1],
              ["F", 14],
              ["L", 90],
              ["W", 2],
              ["R", 90],
              ["W", 3],
              ["F", 76],
              ["S", 5],
              ["W", 5],
              ["F", 93],
              ["W", 4],
              ["R", 90],
              ["F", 57],
              ["E", 3],
              ["R", 90],
              ["S", 3],
              ["W", 1],
              ["R", 90],
              ["S", 3],
              ["F", 8],
              ["R", 90],
              ["N", 2],
              ["F", 46],
              ["W", 4],
              ["S", 1],
              ["L", 90],
              ["E", 4],
              ["W", 5],
              ["L", 90],
              ["W", 2],
              ["F", 69],
              ["N", 5],
              ["W", 5],
              ["F", 80],
              ["N", 3],
              ["E", 4],
              ["L", 90],
              ["E", 4],
              ["F", 25],
              ["S", 3],
              ["R", 180],
              ["F", 77],
              ["R", 90],
              ["W", 2],
              ["F", 19],
              ["E", 4],
              ["L", 180],
              ["W", 2],
              ["F", 37],
              ["S", 2],
              ["F", 68],
              ["L", 90],
              ["E", 2],
              ["F", 66],
              ["S", 1],
              ["R", 90],
              ["F", 66],
              ["E", 2],
              ["L", 180],
              ["F", 97],
              ["N", 3],
              ["W", 4],
              ["F", 43],
              ["S", 4],
              ["R", 180],
              ["N", 1],
              ["R", 270],
              ["E", 3],
              ["N", 2],
              ["N", 3],
              ["F", 65],
              ["L", 90],
              ["S", 2],
              ["L", 90],
              ["N", 3],
              ["L", 90],
              ["S", 3],
              ["F", 23],
              ["L", 270],
              ["W", 3],
              ["S", 5],
              ["E", 2],
              ["R", 90],
              ["S", 1],
              ["F", 85],
              ["N", 3],
              ["R", 90],
              ["W", 4],
              ["F", 58],
              ["E", 1],
              ["L", 90],
              ["N", 3],
              ["L", 90],
              ["E", 2],
              ["S", 1],
              ["F", 14],
              ["E", 2],
              ["N", 5],
              ["W", 1],
              ["N", 3],
              ["E", 1],
              ["L", 90],
              ["E", 3],
              ["F", 43],
              ["E", 3],
              ["N", 3],
              ["F", 21],
              ["E", 4],
              ["F", 53],
              ["E", 2],
              ["L", 180],
              ["E", 4],
              ["F", 20],
              ["E", 2],
              ["N", 2],
              ["E", 5],
              ["L", 90],
              ["N", 4],
              ["W", 3],
              ["N", 4],
              ["S", 2],
              ["L", 90],
              ["W", 3],
              ["F", 96],
              ["L", 90],
              ["S", 3],
              ["R", 90],
              ["N", 1],
              ["E", 3],
              ["S", 5],
              ["L", 270],
              ["F", 41],
              ["N", 5],
              ["W", 5],
              ["S", 1],
              ["W", 5],
              ["R", 90],
              ["F", 79],
              ["W", 3],
              ["L", 90],
              ["E", 3],
              ["F", 22],
              ["N", 1],
              ["L", 90],
              ["E", 2],
              ["L", 90],
              ["R", 90],
              ["F", 20],
              ["L", 90],
              ["W", 3],
              ["R", 90],
              ["W", 2],
              ["L", 180],
              ["W", 4],
              ["F", 57],
              ["R", 180],
              ["N", 3],
              ["L", 90],
              ["F", 36],
              ["L", 90],
              ["E", 2],
              ["R", 90],
              ["N", 2],
              ["E", 3],
              ["N", 1],
              ["W", 4],
              ["W", 4],
              ["N", 3],
              ["E", 5],
              ["F", 54],
              ["R", 180],
              ["F", 98],
              ["W", 1],
              ["R", 90],
              ["F", 21],
              ["S", 1],
              ["L", 90],
              ["S", 2],
              ["L", 90],
              ["S", 2],
              ["F", 90],
              ["E", 4],
              ["S", 2],
              ["R", 90],
              ["N", 5],
              ["F", 25],
              ["N", 4],
              ["W", 3],
              ["N", 2],
              ["F", 27],
              ["S", 3],
              ["E", 3],
              ["N", 3],
              ["F", 15],
              ["L", 180],
              ["S", 4],
              ["F", 62],
              ["W", 2],
              ["L", 180],
              ["E", 2],
              ["N", 2],
              ["L", 90],
              ["R", 90],
              ["F", 97],
              ["R", 90],
              ["S", 1],
              ["R", 90],
              ["E", 2],
              ["F", 16],
              ["W", 2],
              ["E", 1],
              ["F", 89],
              ["W", 1],
              ["L", 180],
              ["S", 3],
              ["W", 2],
              ["S", 3],
              ["E", 1],
              ["F", 92],
              ["F", 30],
              ["N", 1],
              ["E", 2],
              ["S", 1],
              ["F", 76],
              ["E", 1],
              ["S", 5],
              ["W", 5],
              ["F", 28],
              ["W", 4],
              ["L", 90],
              ["F", 44],
              ["E", 4],
              ["N", 5],
              ["F", 25],
              ["R", 90],
              ["F", 59],
              ["S", 4],
              ["F", 58],
              ["S", 2],
              ["F", 19],
              ["W", 5],
              ["S", 4],
              ["E", 5],
              ["N", 3],
              ["F", 37],
              ["E", 1],
              ["L", 90],
              ["F", 40],
              ["E", 5],
              ["F", 56],
              ["S", 2],
              ["W", 5],
              ["F", 73],
              ["N", 5],
              ["F", 2],
              ["L", 90],
              ["F", 18],
              ["E", 2],
              ["N", 5],
              ["L", 90],
              ["F", 56],
              ["R", 90],
              ["F", 18],
              ["W", 1],
              ["S", 5],
              ["E", 1],
              ["N", 1],
              ["L", 90],
              ["W", 2],
              ["E", 4],
              ["N", 4],
              ["E", 1],
              ["W", 4],
              ["N", 4],
              ["L", 90],
              ["N", 3],
              ["R", 90],
              ["W", 5],
              ["S", 5],
              ["F", 2],
              ["R", 180],
              ["F", 96],
              ["R", 90],
              ["W", 3],
              ["F", 26],
              ["L", 90],
              ["S", 4],
              ["E", 2],
              ["F", 43],
              ["S", 2],
              ["R", 90],
              ["F", 61],
              ["W", 5],
              ["F", 93],
              ["R", 90],
              ["F", 95],
              ["L", 90],
              ["E", 4],
              ["R", 90],
              ["N", 4],
              ["F", 47],
              ["R", 90],
              ["W", 5],
              ["L", 90],
              ["F", 42],
              ["L", 90],
              ["W", 5],
              ["F", 87],
              ["R", 90],
              ["N", 1],
              ["N", 2],
              ["E", 4],
              ["F", 64],
              ["S", 5],
              ["L", 270],
              ["F", 86],
              ["S", 4],
              ["W", 3],
              ["S", 1],
              ["L", 90],
              ["F", 72],
              ["R", 270],
              ["W", 1],
              ["F", 17],
              ["S", 1],
              ["E", 2],
              ["R", 90],
              ["W", 1],
              ["N", 1],
              ["F", 42],
              ["N", 5],
              ["L", 90],
              ["F", 87],
              ["F", 66],
              ["L", 90],
              ["N", 2],
              ["W", 2],
              ["L", 90],
              ["S", 5],
              ["F", 7],
              ["R", 90],
              ["N", 4],
              ["L", 270],
              ["F", 2],
              ["W", 1],
              ["N", 4],
              ["F", 94],
              ["W", 5],
              ["R", 180],
              ["S", 4],
              ["F", 15],
              ["E", 4],
              ["F", 76],
              ["N", 1],
              ["E", 2],
              ["F", 68],
              ["S", 3],
              ["F", 50],
              ["R", 270],
              ["E", 5],
              ["F", 77],
              ["R", 90],
              ["S", 3],
              ["E", 2],
              ["N", 3],
              ["S", 4],
              ["F", 39],
              ["S", 1],
              ["E", 5],
              ["S", 3],
              ["L", 90],
              ["E", 4],
              ["S", 2],
              ["W", 3],
              ["F", 54],
              ["R", 90],
              ["F", 44],
              ["L", 90],
              ["W", 3],
              ["F", 59],
              ["R", 90],
              ["N", 3],
              ["F", 37],
              ["E", 1],
              ["F", 75],
              ["R", 90],
              ["F", 31],
              ["W", 3],
              ["F", 70],
              ["S", 5],
              ["L", 90],
              ["E", 1],
              ["F", 67],
              ["W", 4],
              ["L", 90],
              ["S", 1],
              ["W", 5],
              ["S", 1],
              ["S", 4],
              ["W", 2],
              ["E", 2],
              ["S", 3],
              ["R", 90],
              ["S", 2],
              ["E", 5],
              ["L", 90],
              ["F", 43],
              ["R", 90],
              ["E", 1],
              ["S", 5],
              ["F", 42],
              ["L", 90],
              ["W", 1],
              ["N", 2],
              ["E", 1],
              ["L", 180],
              ["S", 4],
              ["W", 1],
              ["L", 90],
              ["F", 81],
              ["E", 1],
              ["R", 180],
              ["N", 5],
              ["R", 180],
              ["N", 5],
              ["L", 180],
              ["F", 65],
              ["R", 90],
              ["F", 64],
              ["W", 4],
              ["S", 4],
              ["R", 90],
              ["F", 70],
              ["E", 1],
              ["S", 1],
              ["F", 50],
              ["E", 2],
              ["S", 4],
              ["E", 4],
              ["N", 2],
              ["S", 1],
              ["R", 90],
              ["E", 4],
              ["R", 90],
              ["F", 70],
              ["R", 90],
              ["N", 4],
              ["F", 71],
              ["R", 180],
              ["F", 80],
              ["S", 3],
              ["L", 90],
              ["N", 5],
              ["L", 180],
              ["F", 11],
              ["N", 1],
              ["R", 90],
              ["W", 2],
              ["N", 1],
              ["R", 90],
              ["W", 4],
              ["R", 90],
              ["F", 67],
              ["W", 3],
              ["R", 90],
              ["W", 5],
              ["L", 90],
              ["E", 4],
              ["F", 90],
              ["L", 90],
              ["N", 4],
              ["L", 180],
              ["F", 48],
              ["R", 90],
              ["W", 2],
              ["F", 94],
              ["R", 90],
              ["N", 4],
              ["L", 90],
              ["W", 2],
              ["F", 2],
              ["L", 90],
              ["W", 1],
              ["E", 5],
              ["S", 2],
              ["W", 5],
              ["S", 5],
              ["E", 2],
              ["N", 3],
              ["W", 5],
              ["N", 1],
              ["F", 98],
              ["S", 3],
              ["W", 3],
              ["L", 90],
              ["S", 3],
              ["W", 4],
              ["R", 90],
              ["W", 1],
              ["F", 64],
              ["N", 5],
              ["R", 90],
              ["S", 5],
              ["W", 5],
              ["F", 84],
              ["S", 1],
              ["E", 3],
              ["L", 90],
              ["S", 3],
              ["E", 5],
              ["F", 6],
              ["N", 4],
              ["W", 1],
              ["R", 90],
              ["E", 4],
              ["F", 14],
              ["N", 1],
              ["R", 90],
              ["F", 31],
              ["L", 90],
              ["F", 24],
              ["F", 4],
              ["N", 4],
              ["F", 54],
              ["S", 3],
              ["R", 270],
              ["F", 98],
              ["E", 1],
              ["L", 180],
              ["F", 2],
              ["E", 4],
              ["F", 70],
              ["W", 1],
              ["R", 180],
              ["N", 5],
              ["F", 23]]

def calculate_new_waypoint(waypoint, angle):
    x = waypoint["east-west"]
    y = waypoint["north-south"]

    angle_rad = np.radians(angle)

    matrix = np.array([
                       [np.cos(angle_rad), (-1*np.sin(angle_rad))],
                       [np.sin(angle_rad),      np.cos(angle_rad)]
                      ])

    vector = np.array([x, y])
    new_vector = matrix.dot(vector)

    # Calculation of radian is not perfectly accurate -> need of round
    # It is also possible to use common rotations instead of calculation (https://www.wikiwand.com/en/Rotation_matrix#/Common_rotations)
    waypoint["east-west"] = int(round(new_vector[0]))
    waypoint["north-south"] = int(round(new_vector[1]))

    return waypoint

def find_all_moves(coord_list):
    ship_coords = {
        "north-south": 0, # y
        "east-west": 0,   # x
    }

    waypoint = {
        "north-south": 1, # y
        "east-west": 10   # x
    }

    for instruction, value in coord_list:
        if instruction == "N":
            waypoint["north-south"] += value
        elif instruction == "S":
            waypoint["north-south"] -= value
        elif instruction == "E":
            waypoint["east-west"] += value
        elif instruction == "W":
            waypoint["east-west"] -= value
        elif instruction == "F":
            ship_coords["north-south"] += waypoint["north-south"] * value
            ship_coords["east-west"] += waypoint["east-west"] * value
        elif instruction == "L":
            waypoint = calculate_new_waypoint(waypoint, value)
        elif instruction == "R":
            waypoint = calculate_new_waypoint(waypoint, (-1*value))
        # print(ship_coords, waypoint)
    return ship_coords

def calulcate_distance(ship_coords):
    north_south = abs(ship_coords["north-south"])
    east_west = abs(ship_coords["east-west"])

    return north_south + east_west

ship_coords = find_all_moves(coord_list)
print(ship_coords)
print(calulcate_distance(ship_coords))